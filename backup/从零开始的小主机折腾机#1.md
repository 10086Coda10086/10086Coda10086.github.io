ä½¿ç”¨è®¾å¤‡ï¼šæƒ æ™® t628

![Image](https://github.com/user-attachments/assets/97c14621-6236-4908-8d65-d89638e65bc1)

å®‰å®‰é™é™åœ°èººåœ¨æˆ‘çš„ä¹¦æŸœä¸Š

## 1. å®‰è£…ç³»ç»Ÿ

å¯ç”¨äºå®¶ç”¨æœåŠ¡å™¨çš„ç³»ç»Ÿé€‰æ‹©å…¶å®å¾ˆå¤šã€‚å›½å†…æœ‰éå¼€æºçš„ FNOSï¼Œå›½å¤–åˆ™æœ‰å¼€æºçš„ TrueNASã€Unraid ç­‰ï¼›é€šç”¨ Linux å‘è¡Œç‰ˆæ–¹é¢ï¼Œè¿˜æœ‰ Ubuntu Serverã€Debianã€ç”šè‡³ Archï¼ˆï¼Ÿï¼‰ï¼›å¦‚æœç¡®å®å­˜åœ¨åˆšéœ€ï¼Œä¹Ÿå¯ä»¥é€‰æ‹© Windows Serverã€‚

ä½†é™¤ä¼ ç»Ÿ Linux å‘è¡Œç‰ˆä»¥å¤–ï¼Œå…¶ä½™ç³»ç»Ÿæ•´ä½“éƒ½åå‘â€œæˆå“åŒ–â€å’Œé›†æˆåŒ–ï¼ŒåŠŸèƒ½é½å…¨çš„åŒæ—¶ä¹Ÿç›¸å¯¹è‡ƒè‚¿ã€‚NAS æœ¬èº«å¯¹æ€§èƒ½è¦æ±‚ä¸é«˜ï¼Œä½†è€ƒè™‘åˆ° t628 çš„ç¡¬ä»¶æ€§èƒ½è¾ƒä¸ºæœ‰é™ï¼Œè¿‡äºå¤æ‚çš„ç³»ç»Ÿåœ¨é•¿æœŸæŠ˜è…¾ä¸‹ä»å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚

ç»¼åˆæ€§èƒ½å¼€é”€ã€ç³»ç»Ÿè‡ªç”±åº¦ä»¥åŠå¯æ§æ€§ï¼Œæˆ‘æœ€ç»ˆé€‰æ‹©äº† **Ubuntu Server**ã€‚ç›¸è¾ƒäº Debianï¼ŒUbuntu Server çš„ç¡®æ›´åè‡ƒè‚¿ä¸€äº›ï¼Œä½†è¿™ç§â€œè‡ƒè‚¿â€ä¹Ÿæ¢æ¥äº†æ›´å‹å¥½çš„ç”Ÿæ€å’Œæ›´ä½çš„ä½¿ç”¨é—¨æ§›ã€‚è‡³äºå¸¸è¢«è¯Ÿç—…çš„ Snapï¼Œè™½ç„¶è°ˆä¸ä¸Šå–œæ¬¢ï¼Œä½†åœ¨å¯æ¥å—èŒƒå›´å†…ï¼Œå®é™…ä½¿ç”¨ä¸­ç¡®å®èƒ½å¸¦æ¥ä¸€å®šä¾¿åˆ©ã€‚

Debian åœ¨ç®€æ´æ€§å’Œç¨³å®šæ€§ä¸Šä¾ç„¶æ›´èƒœä¸€ç­¹ï¼Œä½†æƒè¡¡ä¹‹åï¼Œæˆ‘ä¸ªäººä»ç„¶å¯ä»¥æ¥å— Ubuntu Serverâ€”â€”æ¯•ç«Ÿåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼ŒSnap ç­‰æœºåˆ¶ç¡®å®èƒ½çœä¸‹ä¸å°‘æ—¶é—´å’Œç²¾åŠ›ã€‚

### 1.1 å®‰è£…è¿‡ç¨‹

Ubuntu Server çš„å®‰è£…æµç¨‹æœ¬èº«è¾ƒä¸ºç®€å•ã€‚é¦–å…ˆå‰å¾€ [[Ubuntu å®˜æ–¹ç½‘ç«™](https://ubuntu.com/download/server)](https://ubuntu.com/download/server) ä¸‹è½½ç³»ç»Ÿé•œåƒï¼Œç„¶åé€šè¿‡å¯åŠ¨ç›˜å®Œæˆå®‰è£…å³å¯ã€‚æ— è®ºæ˜¯ä½¿ç”¨ **Rufus** è¿˜æ˜¯ **Ventoy**ï¼Œæ–¹å¼å¹¶æ— æœ¬è´¨åŒºåˆ«ï¼Œåªè¦èƒ½æ­£å¸¸å¼•å¯¼å¹¶å®Œæˆå®‰è£…å³å¯ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½ è®¡åˆ’å°†ä¸»æœºæ”¾ç½®åœ¨**æ— äººå€¼å®ˆ**æˆ–**ä¸ä¾¿è¿æ¥æ˜¾ç¤ºå™¨ä¸é”®ç›˜**çš„ä½ç½®ï¼Œå»ºè®®åœ¨å®‰è£…é˜¶æ®µå°±é…ç½®å¥½ **SSH**ï¼Œä»¥ä¾¿åç»­è¿œç¨‹ç®¡ç†ã€‚

ä¸‹é¢æ˜¯å…·ä½“çš„ SSH é…ç½®æµç¨‹ã€‚

------

#### 1.1.1 SSH é…ç½®æ•™ç¨‹

é¦–å…ˆï¼Œåœ¨ä½ **æ—¥åç”¨äºç®¡ç†æœåŠ¡å™¨çš„ç”µè„‘**ä¸Šæ‰“å¼€ç»ˆç«¯ï¼ˆå¦‚æœæ‰¾ä¸åˆ°ï¼Œå¯ä»¥ç›´æ¥åœ¨æœç´¢æ ä¸­æœç´¢â€œç»ˆç«¯â€æˆ–â€œPowerShellâ€ï¼‰ã€‚

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ SSH å¯†é’¥ï¼š

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

> è¯·å°† `your_email@example.com` æ›¿æ¢ä¸ºä½ è‡ªå·±çš„é‚®ç®±ã€‚è™½ç„¶è¯¥å­—æ®µå¹¶ä¸å½±å“åŠŸèƒ½ï¼Œä½†ç”¨äºæ ‡è¯†å¯†é’¥ï¼Œå»ºè®®å¡«å†™ã€‚

éšåä¸€è·¯å›è½¦ï¼ˆé€šå¸¸ 3ï½4 æ¬¡ï¼‰ï¼Œç›´åˆ°å‘½ä»¤æ‰§è¡Œç»“æŸã€‚

ç”Ÿæˆå®Œæˆåï¼Œå¯†é’¥æ–‡ä»¶é»˜è®¤ä½äºï¼š

```
C:\Users\ä½ çš„ç”¨æˆ·å\.ssh\
â”œâ”€ id_ed25519        ï¼ˆç§é’¥ï¼Œ**åŠ¡å¿…å¦¥å–„ä¿ç®¡ï¼Œç»ä¸å¯æ³„éœ²**ï¼‰
â””â”€ id_ed25519.pub    ï¼ˆå…¬é’¥ï¼Œç”¨äºæœåŠ¡å™¨æˆ– GitHubï¼‰
```

æ¥ä¸‹æ¥å¤åˆ¶å…¬é’¥å†…å®¹ï¼ˆä¾›åç»­ä½¿ç”¨ï¼‰ï¼š

```powershell
type $env:USERPROFILE\.ssh\id_ed25519.pub
```

è¯·**å®Œæ•´å¤åˆ¶è¾“å‡ºçš„æ•´è¡Œå†…å®¹**ã€‚

------

##### å°† SSH Key æ·»åŠ åˆ° GitHub

å¦‚æœå°šæœªæ³¨å†Œ GitHub è´¦å·ï¼Œè¯·å…ˆå®Œæˆæ³¨å†Œã€‚

1. æ‰“å¼€ GitHub
2. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ **Settings**
3. å·¦ä¾§é€‰æ‹© **SSH and GPG keys**
4. ç‚¹å‡» **New SSH key**
5. å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Title**ï¼š
     ä»»æ„ï¼Œç”¨äºåŒºåˆ†è®¾å¤‡
     ç¤ºä¾‹ï¼š`debian-server` / `laptop` / `home-nas`
   - **Key type**ï¼š
     ä¿æŒé»˜è®¤ `Authentication Key`
   - **Key**ï¼š
     ç²˜è´´åˆšæ‰å¤åˆ¶çš„**å®Œæ•´å…¬é’¥**
6. ç‚¹å‡» **Add SSH key**
7. æŒ‰æç¤ºè¾“å…¥ GitHub å¯†ç ç¡®è®¤

------

æœ€åï¼Œåœ¨ **Ubuntu Server å®‰è£…è¿‡ç¨‹ä¸­**ï¼š

- å¯ç”¨ **SSH æœåŠ¡**
- é€‰æ‹© **ä» GitHub å¯¼å…¥ SSH key**
- è¾“å…¥å¯¹åº”çš„ **GitHub ç”¨æˆ·å**

è¿™æ ·åœ¨ç³»ç»Ÿå®‰è£…å®Œæˆåï¼Œå³å¯ç›´æ¥é€šè¿‡ SSH ä½¿ç”¨å¯†é’¥ç™»å½•æœåŠ¡å™¨ï¼Œæ— éœ€å†è¿›è¡Œé¢å¤–é…ç½®ã€‚

è¦æƒ³ç™»å½•ä¹Ÿå¾ˆç®€å•ï¼Œç»ˆç«¯è¾“å…¥

`ssh ç”¨æˆ·å@ipåœ°å€`

æœ‰å¯èƒ½ä¼šé—®ä½ yes/no/fingerprintï¼Œç›´æ¥yeså³å¯ã€‚

ç„¶åè¾“å…¥è´¦å·å¯†ç å°±è¡Œäº†ã€‚

#### 1.1.2 é…ç½®è½¯ä»¶æº

Ubuntu é»˜è®¤ä½¿ç”¨çš„å®˜æ–¹è½¯ä»¶æºåœ¨å›½å†…è®¿é—®é€Ÿåº¦å’Œç¨³å®šæ€§éƒ½ä¸ç†æƒ³ï¼Œå®é™…ä½¿ç”¨ä¸­å®¹æ˜“å‡ºç°ä¸‹è½½æ…¢ç”šè‡³å¤±è´¥çš„æƒ…å†µã€‚å› æ­¤ï¼Œå»ºè®®åœ¨å®‰è£…é˜¶æ®µæˆ–å®‰è£…å®Œæˆåï¼Œå°†è½¯ä»¶æºåˆ‡æ¢ä¸ºå›½å†…é•œåƒç«™ï¼Œä¾‹å¦‚ **æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™**ã€‚

åœ¨ **Ubuntu Server å®‰è£…è¿‡ç¨‹ä¸­**ï¼Œå½“å®‰è£…ç¨‹åºè¯¢é—®è½¯ä»¶æºåœ°å€æ—¶ï¼Œå¯ä»¥ç›´æ¥å¡«å†™æ¸…åæºï¼š

```
https://mirrors.tuna.tsinghua.edu.cn/ubuntu/
```

å¦‚æœåœ¨å®‰è£…é˜¶æ®µæœªè¿›è¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨ç³»ç»Ÿå®‰è£…å®Œæˆåæ‰‹åŠ¨ä¿®æ”¹ `/etc/apt/sources.list` æ¥å®Œæˆåˆ‡æ¢ã€‚åˆ‡æ¢å®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ›´æ–°è½¯ä»¶ç´¢å¼•ï¼š

```bash
sudo apt update
```

æ›´æ¢ä¸ºå›½å†…é•œåƒæºåï¼Œ`apt` åœ¨ä¸‹è½½è½¯ä»¶åŒ…å’Œæ›´æ–°ç³»ç»Ÿæ—¶çš„é€Ÿåº¦ä¸ç¨³å®šæ€§éƒ½ä¼šæœ‰æ˜æ˜¾æ”¹å–„ï¼Œå°¤å…¶æ˜¯åœ¨é¦–æ¬¡å®‰è£…å¤§é‡ä¾èµ–æ—¶æ•ˆæœå°¤ä¸ºæ˜æ˜¾ã€‚

## 2. åˆæ­¥é…ç½®ç³»ç»Ÿ

### 2.1 æ›´æ–°ç³»ç»Ÿä¸åŸºç¡€å·¥å…·

åœ¨å¼€å§‹è¿›ä¸€æ­¥é…ç½®ä¹‹å‰ï¼Œå»ºè®®å…ˆå¯¹ç³»ç»Ÿè¿›è¡Œä¸€æ¬¡å®Œæ•´æ›´æ–°ï¼Œå¹¶å®‰è£…ä¸€äº›å¸¸ç”¨çš„åŸºç¡€å·¥å…·ã€‚

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y curl wget vim htop net-tools
```

è¿™ä¸¤è¡Œæ˜¯ **Debian / Ubuntu ç³»åˆ—**é‡Œéå¸¸å¸¸è§çš„åˆå§‹åŒ–å‘½ä»¤ï¼Œä½œç”¨å¯ä»¥åˆ†å¼€ç²¾ç¡®è¯´æ˜ã€‚

ç¬¬ä¸€è¡Œ

```bash
sudo apt update && sudo apt upgrade -y
```

`sudo`

ä»¥ **root æƒé™**æ‰§è¡Œã€‚æ™®é€šç”¨æˆ·é»˜è®¤ä¸èƒ½æ”¹ç³»ç»Ÿè½¯ä»¶ã€‚

`apt update`

- **æ›´æ–°è½¯ä»¶æºç´¢å¼•**
- ä» `/etc/apt/sources.list` åŠ `/etc/apt/sources.list.d/` ä¸­é…ç½®çš„é•œåƒç«™ï¼š
  - ä¸‹è½½â€œæœ‰å“ªäº›è½¯ä»¶ã€æœ‰å“ªäº›ç‰ˆæœ¬â€çš„**æ¸…å•**
- â—ä¸ä¼šå®‰è£…æˆ–å‡çº§ä»»ä½•è½¯ä»¶

å¯ä»¥ç†è§£ä¸ºï¼š**åˆ·æ–°å¯ç”¨è½¯ä»¶åˆ—è¡¨**

`&&`

- **é€»è¾‘ä¸**
- å«ä¹‰æ˜¯ï¼š
  ğŸ‘‰ **åªæœ‰å‰ä¸€ä¸ªå‘½ä»¤æˆåŠŸï¼Œæ‰æ‰§è¡Œåä¸€ä¸ª**

å¦‚æœ `apt update` å¤±è´¥ï¼Œ`apt upgrade` ä¸ä¼šæ‰§è¡Œã€‚

`apt upgrade -y`

- **å‡çº§å·²å®‰è£…çš„è½¯ä»¶åŒ…**
- åªå‡çº§ï¼š
  - å·²å®‰è£…
  - ä¸”ä¸éœ€è¦åˆ é™¤æ—§åŒ…ã€ä¸å¼•å…¥å†²çªçš„æ–°åŒ…
- `-y` è¡¨ç¤ºï¼š
  - è‡ªåŠ¨å›ç­” â€œyesâ€
  - ä¸å†äº¤äº’ç¡®è®¤

âš ï¸ ä¸ä¼šå‡çº§å†…æ ¸å¤§ç‰ˆæœ¬ã€ä¸ä¼šè‡ªåŠ¨ç§»é™¤åŒ…
ï¼ˆé‚£æ˜¯ `full-upgrade` / `dist-upgrade` å¹²çš„äº‹ï¼‰

ç¬¬ä¸€è¡Œæ€»ç»“

> **åˆ·æ–°è½¯ä»¶æº â†’ æŠŠç³»ç»Ÿä¸­èƒ½å®‰å…¨å‡çº§çš„è½¯ä»¶å…¨éƒ¨å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬**

ç¬¬äºŒè¡Œ

```bash
sudo apt install -y curl wget vim htop net-tools
```

å«ä¹‰

- ä½¿ç”¨ `apt` å®‰è£…ä¸€ç»„**å¸¸ç”¨å·¥å…·**
- `-y`ï¼šä¸è¯¢é—®ï¼Œç›´æ¥å®‰è£…

å„è½¯ä»¶å…·ä½“ä½œç”¨

`curl`

- å‘½ä»¤è¡Œ **HTTP/HTTPS å®¢æˆ·ç«¯**
- å¸¸è§ç”¨é€”ï¼š
  - è°ƒç”¨ API
  - ä¸‹è½½æ–‡ä»¶
  - ä¸€é”®è„šæœ¬ï¼ˆ`curl | bash`ï¼‰

ç¤ºä¾‹ï¼š

```bash
curl https://example.com
```

`wget`

- å‘½ä»¤è¡Œ **æ–‡ä»¶ä¸‹è½½å·¥å…·**
- æ›´åå‘â€œç¨³å®šä¸‹è½½â€

ç¤ºä¾‹ï¼š

```bash
wget https://example.com/file.zip
```

ğŸ“Œ `curl` æ›´çµæ´»ï¼Œ`wget` æ›´ä¸“æ³¨ä¸‹è½½
å¾ˆå¤šæœåŠ¡å™¨æ•™ç¨‹ä¼š**ä¸¤ä¸ªéƒ½è£…**

`vim`

- ç»ˆç«¯æ–‡æœ¬ç¼–è¾‘å™¨
- å¸¸ç”¨äºï¼š
  - ç¼–è¾‘é…ç½®æ–‡ä»¶
  - æ”¹ systemd / nginx / docker é…ç½®

ç¤ºä¾‹ï¼š

```bash
vim /etc/ssh/sshd_config
```

`htop`

- äº¤äº’å¼ **è¿›ç¨‹/èµ„æºç›‘æ§**
- æ¯” `top`ï¼š
  - æ›´ç›´è§‚
  - æ”¯æŒé¼ æ ‡
  - å½©è‰²ç•Œé¢

ç¤ºä¾‹ï¼š

```bash
htop
```

`net-tools`

- æä¾›è€ä¸€ä»£ç½‘ç»œå‘½ä»¤ï¼š
  - `ifconfig`
  - `netstat`
  - `route`
- âš ï¸ å·²è¢« `iproute2`ï¼ˆ`ip a`, `ss`ï¼‰å–ä»£
- ä½†**å¾ˆå¤šè€æ•™ç¨‹ä»ä¾èµ–å®ƒ**

ç¬¬äºŒè¡Œæ€»ç»“

> **å®‰è£…ä¸€å¥—å‡ ä¹æ‰€æœ‰æœåŠ¡å™¨ / Linux æ–°ç³»ç»Ÿéƒ½ä¼šè£…çš„åŸºç¡€å·¥å…·**

æ•´ä½“ä¸€å¥è¯æ€»ç»“

è¿™ä¸¤è¡Œå‘½ä»¤çš„ç›®çš„å°±æ˜¯ï¼š

> **æ›´æ–°ç³»ç»Ÿ â†’ å‡çº§å·²æœ‰è½¯ä»¶ â†’ å®‰è£…ä¸€å¥—å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä½œä¸ºç³»ç»Ÿçš„â€œåŸºç¡€ç¯å¢ƒâ€**

---

æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡å®‰è£…ä¸€æ¬¾ç®€å•çš„å·¥å…·æ¥éªŒè¯è½¯ä»¶æºå’Œç³»ç»Ÿæ˜¯å¦å·¥ä½œæ­£å¸¸ã€‚è¿™é‡Œä»¥ **neofetch** ä¸ºä¾‹ï¼Œè¯¥å·¥å…·ç”¨äºåœ¨ç»ˆç«¯ä¸­å±•ç¤ºç³»ç»Ÿçš„åŸºæœ¬ä¿¡æ¯ã€‚

```bash
sudo apt install neofetch
```

æŒ‰æç¤ºè¾“å…¥ `y` ç¡®è®¤å®‰è£…ã€‚å®‰è£…å®Œæˆåï¼Œç›´æ¥æ‰§è¡Œï¼š

```bash
neofetch
```

å³å¯çœ‹åˆ°ç³»ç»Ÿä¿¡æ¯çš„æ±‡æ€»å±•ç¤ºç•Œé¢ï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img width="1920" height="1048" alt="Image" src="https://github.com/user-attachments/assets/8fa03b28-1b6e-4b91-8eae-9cd9f0c2d820" />

å¦‚æœèƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºï¼Œè¯´æ˜å½“å‰è½¯ä»¶æºé…ç½®ä¸åŸºç¡€ç¯å¢ƒå‡å·¥ä½œæ­£å¸¸ï¼Œå¯ä»¥ç»§ç»­åç»­çš„ç³»ç»Ÿé…ç½®ä¸æœåŠ¡éƒ¨ç½²ã€‚

#### 2.1.1 å®‰è£…â€œæ‰¶æ‰‹æ¢¯â€

åå­—å«â€œæ‰¶æ‰‹æ¢¯â€ï¼Œä½†å®é™…ä¸Šå°±æ˜¯ä½ ç†è§£çš„é‚£ä¸ªâ€”â€”ç½‘ç»œä»£ç†å·¥å…·ã€‚

ç”±äºåç»­ä¼šå¤§é‡ä½¿ç”¨ **Docker**ï¼ŒåŒ…æ‹¬æ‹‰å–é•œåƒã€è®¿é—® GitHub ç­‰èµ„æºï¼Œå¦‚æœæ²¡æœ‰ç¨³å®šçš„ç½‘ç»œç¯å¢ƒï¼Œå®é™…ä½“éªŒä¼šéå¸¸ç³Ÿç³•ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥å‡ ä¹æ˜¯å¿…éœ€çš„å‰ç½®æ¡ä»¶ã€‚

è¿™é‡Œç›´æ¥ä½¿ç”¨ [[nelvko](https://github.com/nelvko)](https://github.com/nelvko) å¤§ä½¬æä¾›çš„è„šæœ¬ï¼Œæ•´ä½“å®‰è£…è¿‡ç¨‹ç›¸å¯¹çœå¿ƒã€‚

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å¼€å§‹å®‰è£…ï¼š

```bash
git clone --branch master --depth 1 https://gh-proxy.org/https://github.com/nelvko/clash-for-linux-install.git \
  && cd clash-for-linux-install \
  && bash install.sh
```

å®‰è£…è¿‡ç¨‹ä¸­æŒ‰ç…§è„šæœ¬æç¤ºæ“ä½œå³å¯ï¼ŒåŸºæœ¬ä¸éœ€è¦é¢å¤–å¹²é¢„ã€‚

å¦‚æœä½ è¿˜æ²¡æœ‰å¯ç”¨çš„è®¢é˜…é“¾æ¥ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« ï¼š
ğŸ‘‰ [[ä½ä»·æœºåœºæ¨è](https://blog.realityme.top/2025/08/02/%E4%BD%8E%E4%BB%B7%E6%9C%BA%E5%9C%BA%E6%8E%A8%E8%8D%90/)](https://blog.realityme.top/2025/08/02/ä½ä»·æœºåœºæ¨è/)

æ¥ç€é‡å¯ã€‚

**æ³¨ï¼š**ä¸€äº›å¯èƒ½ç”¨åˆ°çš„å‘½ä»¤ï¼š

```
Usage: 
  clashctl COMMAND [OPTIONS]

Commands:
    on                    å¼€å¯ä»£ç†
    off                   å…³é—­ä»£ç†
    status                å†…æ ¸çŠ¶å†µ
    proxy                 ç³»ç»Ÿä»£ç†
    ui                    Web é¢æ¿
    secret                Web å¯†é’¥
    sub                   è®¢é˜…ç®¡ç†
    upgrade               å‡çº§å†…æ ¸
    tun                   Tun æ¨¡å¼
    mixin                 Mixin é…ç½®

Global Options:
    -h, --help            æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
    
æ›´ä¼˜é›…çš„æ–¹å¼ï¼š
$ clashon
ğŸ˜¼ å·²å¼€å¯ä»£ç†ç¯å¢ƒ

$ clashoff
ğŸ˜¼ å·²å…³é—­ä»£ç†ç¯å¢ƒ
```

æ›´å¤šå†…å®¹æŸ¥çœ‹[[GitHubä»“åº“](https://github.com/nelvko/clash-for-linux-install)](https://github.com/nelvko/clash-for-linux-install)

å®Œæˆä»¥ä¸Šé…ç½®åï¼Œåç»­æ— è®ºæ˜¯ Docker æ‹‰é•œåƒè¿˜æ˜¯è®¿é—®å„ç±»å›½å¤–æœåŠ¡ï¼Œæ•´ä½“ä½“éªŒéƒ½ä¼šé¡ºç•…è®¸å¤šï¼Œå¯ä»¥ç»§ç»­å®‰å¿ƒæŠ˜è…¾äº†ã€‚

#### 2.1.2 å®‰è£… Docker ä¸ Compose

Docker æ˜¯åç»­æœåŠ¡éƒ¨ç½²çš„æ ¸å¿ƒç»„ä»¶ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ä¸€é”®å®‰è£…è„šæœ¬è¿›è¡Œå®‰è£…ï¼Œçœå»æ‰‹åŠ¨é…ç½®ä¾èµ–çš„æ­¥éª¤ã€‚

ä¸‹é¢æˆ‘ä¼š**é€æ¡ã€é€å‘½ä»¤è§£é‡Š**åœ¨ Ubuntu ä¸Šå®‰è£… **Docker Engine + Docker Composeï¼ˆv2ï¼‰** çš„å…¨è¿‡ç¨‹ã€‚å†…å®¹åâ€œåŸç† + å®æ“â€ï¼Œé€‚åˆç†è§£è€Œä¸æ˜¯åªç…§æŠ„ã€‚

> é€‚ç”¨ç³»ç»Ÿï¼šUbuntu 20.04 / 22.04 / 24.04ï¼ˆDesktop / Server é€šç”¨ï¼‰

------

##### ä¸€ã€ä¸ºä»€ä¹ˆä¸ç›´æ¥ `apt install docker`

Ubuntu è‡ªå¸¦ä»“åº“é‡Œçš„ Docker ç‰ˆæœ¬é€šå¸¸ï¼š

- **ç‰ˆæœ¬æ—§**
- **åŠŸèƒ½ä¸å…¨**
- **Compose ä¸æ˜¯ v2**

å› æ­¤å®˜æ–¹æ¨èï¼š

> **ä½¿ç”¨ Docker å®˜æ–¹ä»“åº“å®‰è£…**

------

##### äºŒã€å‡†å¤‡ç³»ç»Ÿä¾èµ–

```bash
sudo apt update
sudo apt install -y ca-certificates curl gnupg lsb-release
```

###### é€é¡¹è§£é‡Š

###### 1ï¸âƒ£ `apt update`

- æ›´æ–°æœ¬åœ° **è½¯ä»¶ç´¢å¼•**
- ä¸å®‰è£…ä»»ä½•ä¸œè¥¿
- ç›¸å½“äºâ€œåˆ·æ–°åº”ç”¨å•†åº—â€

------

###### 2ï¸âƒ£ `ca-certificates`

- æä¾› **HTTPS è¯ä¹¦**
- æ²¡å®ƒï¼š
  - HTTPS æºå¯èƒ½æŠ¥é”™
  - curl è®¿é—® https://download.docker.com/ ä¼šå¤±è´¥

------

###### 3ï¸âƒ£ `curl`

- å‘½ä»¤è¡Œä¸‹è½½å·¥å…·
- åé¢ç”¨å®ƒï¼š
  - ä¸‹è½½ Docker çš„ GPG å…¬é’¥

------

###### 4ï¸âƒ£ `gnupg`

- GPG åŠ å¯†å·¥å…·
- ç”¨æ¥ï¼š
  - éªŒè¯ Docker è½¯ä»¶åŒ… **æ˜¯å¦è¢«ç¯¡æ”¹**

------

###### 5ï¸âƒ£ `lsb-release`

- ç”¨æ¥è¯†åˆ« Ubuntu ç‰ˆæœ¬ä»£å·
- æ¯”å¦‚ï¼š
  - 22.04 â†’ `jammy`
  - 24.04 â†’ `noble`

------

##### ä¸‰ã€æ·»åŠ  Docker å®˜æ–¹ GPG Keyï¼ˆå®‰å…¨æ ¸å¿ƒï¼‰

###### 1ï¸âƒ£ åˆ›å»º keyrings ç›®å½•

```bash
sudo install -m 0755 -d /etc/apt/keyrings
```

è§£é‡Š

- `/etc/apt/keyrings`
  ç”¨æ¥å­˜æ”¾ **ç¬¬ä¸‰æ–¹ä»“åº“çš„å…¬é’¥**
- `0755`
  - æ‰€æœ‰äººå¯è¯»
  - root å¯å†™
- `install -d`
  - æ¯” `mkdir` æ›´å®‰å…¨ã€è§„èŒƒ

------

###### 2ï¸âƒ£ ä¸‹è½½å¹¶è½¬æ¢ Docker å…¬é’¥

```bash
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
```

æ‹†è§£ç†è§£

`curl -fsSL`

- `-f`ï¼šå¤±è´¥æ—¶ä¸è¾“å‡º HTML
- `-s`ï¼šé™é»˜
- `-S`ï¼šå‡ºé”™æ—¶æ˜¾ç¤ºé”™è¯¯
- `-L`ï¼šè·Ÿéšé‡å®šå‘

`|` ç®¡é“

- æŠŠä¸‹è½½çš„å…¬é’¥å†…å®¹ä¼ ç»™ `gpg`

`gpg --dearmor`

- Docker æä¾›çš„æ˜¯ **ASCII æ ¼å¼å…¬é’¥**
- apt éœ€è¦ **äºŒè¿›åˆ¶æ ¼å¼**
- `--dearmor` å°±æ˜¯è½¬æ¢æ ¼å¼

------

###### 3ï¸âƒ£ è®¾ç½®è¯»å–æƒé™

```bash
sudo chmod a+r /etc/apt/keyrings/docker.gpg
```

è§£é‡Š

- apt æ˜¯æ™®é€šç”¨æˆ·è¿›ç¨‹
- å¦‚æœä¸èƒ½è¯»è¿™ä¸ª keyï¼š
  - apt update ä¼šå¤±è´¥

------

##### å››ã€æ·»åŠ  Docker å®˜æ–¹è½¯ä»¶æº

```bash
echo \
"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
https://download.docker.com/linux/ubuntu \
$(lsb_release -cs) stable" | \
sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

------

###### é€æ®µè§£é‡Š

1ï¸âƒ£ `dpkg --print-architecture`

è¾“å‡ºï¼š

- `amd64`ï¼ˆä½ çš„ i5-1135G7 å°±æ˜¯ï¼‰
- ç”¨äºç¡®ä¿æ¶æ„åŒ¹é…

------

2ï¸âƒ£ `signed-by=...`

å‘Šè¯‰ aptï¼š

> **è¿™ä¸ªä»“åº“å¿…é¡»ç”¨ docker.gpg éªŒè¯**

è¿™æ˜¯ç°ä»£ apt çš„å®‰å…¨å†™æ³•
ï¼ˆæ—§çš„ `apt-key` å·²è¢«å¼ƒç”¨ï¼‰

------

3ï¸âƒ£ `$(lsb_release -cs)`

è‡ªåŠ¨è¯†åˆ«ç‰ˆæœ¬ä»£å·ï¼š

- 20.04 â†’ `focal`
- 22.04 â†’ `jammy`
- 24.04 â†’ `noble`

é¿å…æ‰‹å†™å‡ºé”™

------

4ï¸âƒ£ `/etc/apt/sources.list.d/docker.list`

- å•ç‹¬æ”¾ Docker çš„æº
- ä¸æ±¡æŸ“ç³»ç»Ÿä¸» sources.list
- æ–¹ä¾¿ä»¥ååˆ é™¤æˆ–ç®¡ç†

------

5ï¸âƒ£ `> /dev/null`

- å±è”½è¾“å‡º
- é˜²æ­¢ç»ˆç«¯æ˜¾ç¤ºé‡å¤å†…å®¹

------

##### äº”ã€åˆ·æ–°ç´¢å¼•

```bash
sudo apt update
```

æ­¤æ—¶ apt ä¼šï¼š

- è®¿é—® Docker å®˜æ–¹æœåŠ¡å™¨
- æ ¡éªŒ GPG ç­¾å
- æ‹‰å– Docker è½¯ä»¶åŒ…åˆ—è¡¨

å¦‚æœè¿™ä¸€æ­¥ä¸æŠ¥é”™ï¼Œè¯´æ˜ï¼š

> **ä»“åº“é…ç½®å®Œå…¨æ­£ç¡®**

------

##### å…­ã€å®‰è£… Docker ä¸ Compose

```bash
sudo apt install -y \
docker-ce \
docker-ce-cli \
containerd.io \
docker-buildx-plugin \
docker-compose-plugin
```

------

###### æ¯ä¸ªåŒ…æ˜¯å¹²å˜›çš„

ğŸ§± `docker-ce`

- Docker **æ ¸å¿ƒæœåŠ¡**
- åå°å®ˆæŠ¤è¿›ç¨‹ï¼ˆdockerdï¼‰

------

ğŸ–¥ `docker-ce-cli`

- `docker` å‘½ä»¤æœ¬ä½“
- æ²¡å®ƒä½ æ— æ³•æ•² docker

------

ğŸ“¦ `containerd.io`

- å®¹å™¨è¿è¡Œæ—¶
- å®é™…è´Ÿè´£ï¼š
  - æ‹‰é•œåƒ
  - åˆ›å»ºå®¹å™¨
  - ç®¡ç†ç”Ÿå‘½å‘¨æœŸ

Docker æœ¬è´¨ä¸Šæ˜¯ containerd çš„â€œä¸Šå±‚ç®¡ç†å™¨â€

------

ğŸ— `docker-buildx-plugin`

- æ–°ä¸€ä»£æ„å»ºå¼•æ“
- æ”¯æŒï¼š
  - å¤šæ¶æ„é•œåƒ
  - cache
  - å¹¶è¡Œæ„å»º

------

ğŸ§© `docker-compose-plugin`

- **Compose v2**
- é›†æˆè¿› docker å‘½ä»¤
- ä½¿ç”¨æ–¹å¼æ˜¯ï¼š

```bash
docker compose ...
```

âŒ ä¸å†æ˜¯ï¼š

```bash
docker-compose
```

------

##### ä¸ƒã€éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ

```bash
docker version
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š

- Client
- Server
- API version
- Engine version

------

```bash
docker compose version
```

ç¡®è®¤ï¼š

- æ˜¯ v2.x
- ä¸æ˜¯ python compose

------

##### å…«ã€æµ‹è¯• Docker æ˜¯å¦èƒ½è·‘å®¹å™¨

```bash
sudo docker run --rm hello-world
```

###### å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

1. æœ¬åœ°æ²¡é•œåƒ â†’ è‡ªåŠ¨æ‹‰å–
2. åˆ›å»ºå®¹å™¨
3. æ‰“å°æ¬¢è¿ä¿¡æ¯
4. `--rm` è‡ªåŠ¨åˆ é™¤å®¹å™¨

è¿™ä¸€æ­¥æˆåŠŸï¼š

> Docker è¿è¡Œé“¾è·¯å®Œæ•´

------

##### ä¹ã€ä¸ºä»€ä¹ˆé»˜è®¤è¦ sudoï¼Ÿ

###### åŸå› 

- Docker å®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨ root
- socket åœ¨ï¼š

```bash
/var/run/docker.sock
```

------

##### åã€å… sudo ä½¿ç”¨ Dockerï¼ˆå…³é”®ï¼‰

```bash
sudo usermod -aG docker $USER
```

###### è§£é‡Š

- æŠŠå½“å‰ç”¨æˆ·åŠ å…¥ `docker` ç”¨æˆ·ç»„
- è¯¥ç»„å¯¹ docker.sock æœ‰æƒé™

------

âš ï¸ **å¿…é¡»æ³¨é”€ / é‡æ–°ç™»å½•**
å¦åˆ™ç»„æƒé™ä¸ä¼šç”Ÿæ•ˆ

éªŒè¯ï¼š

```bash
groups
```

------

##### åä¸€ã€Compose å·¥ä½œåŸç†ï¼ˆç®€è¿°ï¼‰

- `docker-compose.yml`ï¼š
  - å®šä¹‰å¤šä¸ªå®¹å™¨
  - ç½‘ç»œ
  - å·æŒ‚è½½
- `docker compose up`
  - è‡ªåŠ¨åˆ›å»ºç½‘ç»œ
  - è‡ªåŠ¨æ‹‰é•œåƒ
  - è‡ªåŠ¨å¯åŠ¨é¡ºåº

##### æ€»ç»“ï¼š

------

###### ä¸€ã€å‡†å¤‡å·¥ä½œ

```bash
sudo apt update
sudo apt install -y ca-certificates curl gnupg lsb-release
```

------

###### äºŒã€æ·»åŠ  Docker å®˜æ–¹ä»“åº“

1. å¯¼å…¥ GPG key

```bash
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg
```

2. æ·»åŠ æº

```bash
echo \
"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
https://download.docker.com/linux/ubuntu \
$(lsb_release -cs) stable" | \
sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

3. æ›´æ–°ç´¢å¼•

```bash
sudo apt update
```

------

###### ä¸‰ã€å®‰è£… Docker Engine ä¸ Compose

```bash
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

> æ³¨æ„ï¼š
>
> - **docker-compose-plugin** å³ **Compose v2**ï¼ˆæ¨èï¼‰
> - ä¸å†å»ºè®®å•ç‹¬å®‰è£…æ—§çš„ `docker-compose`ï¼ˆPython ç‰ˆï¼‰

------

###### å››ã€éªŒè¯å®‰è£…

```bash
docker version
docker compose version
```

æµ‹è¯•å®¹å™¨ï¼š

```bash
sudo docker run --rm hello-world
```

------

###### äº”ã€å… sudo ä½¿ç”¨ Dockerï¼ˆå¼ºçƒˆå»ºè®®ï¼‰

```bash
sudo usermod -aG docker $USER
```

ç„¶å**æ³¨é”€å¹¶é‡æ–°ç™»å½•**ï¼Œå†æµ‹è¯•ï¼š

```bash
docker ps
```

------

###### å…­ã€Docker Compose ä½¿ç”¨ç¤ºä¾‹

```bash
mkdir ~/compose-test && cd ~/compose-test
```

`docker-compose.yml`ï¼š

```yaml
services:
  nginx:
    image: nginx:alpine
    ports:
      - "8080:80"
```

å¯åŠ¨ï¼š

```bash
docker compose up -d
```

åœæ­¢ï¼š

```bash
docker compose down
```

------

###### ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥

- **æƒé™é”™è¯¯ï¼ˆpermission deniedï¼‰**
  â†’ æ²¡æœ‰é‡æ–°ç™»å½•ï¼Œæˆ–æœªåŠ å…¥ `docker` ç»„
- **compose å‘½ä»¤ä¸å­˜åœ¨**
  â†’ ç¡®è®¤å®‰è£…çš„æ˜¯ `docker-compose-plugin`ï¼Œå‘½ä»¤æ˜¯
  `docker compose`ï¼ˆä¸­é—´æœ‰ç©ºæ ¼ï¼‰
- **æœåŠ¡å™¨ç¯å¢ƒ**
  Ubuntu Server ä¸ Desktop å®‰è£…æ–¹å¼å®Œå…¨ä¸€è‡´